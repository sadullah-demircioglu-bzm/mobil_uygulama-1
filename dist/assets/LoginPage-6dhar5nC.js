import{u as E,r as n,j as e,I,a as K,b as z,c as j,d as L,e as X,f as w,s as M,g as A}from"./index-DScGTkQE.js";import{h as O,E as D}from"./api-BPEy0ugj.js";import{P as B}from"./PhoneInput-wFrj9W-I.js";const Z=({onLogin:F})=>{const d=E(),[c,k]=n.useState(""),[p,C]=n.useState(""),[u,b]=n.useState(""),[h,T]=n.useState("+90"),[s,g]=n.useState("tc"),[v,t]=n.useState(!1),[P,a]=n.useState(""),[m,x]=n.useState(!1),_=o=>!0,S=async o=>{var f,y;if(o.preventDefault(),!m){if(s==="tc"){if(!c){a("Lütfen T.C. Kimlik No giriniz."),t(!0);return}if(c.length!==11){a("T.C. Kimlik No 11 haneli olmalıdır."),t(!0);return}if(!_()){a("Geçersiz T.C. Kimlik No."),t(!0);return}}else{if(!p){a("Lütfen Pasaport No giriniz."),t(!0);return}if(p.length<6){a("Pasaport No en az 6 karakter olmalıdır."),t(!0);return}}if(!u){a("Lütfen telefon numarası giriniz."),t(!0);return}if(u.length!==10){a("Telefon numarası 10 haneli olmalıdır."),t(!0);return}try{x(!0);const i=`${h.replace("+","")}${u}`,l=s==="tc"?{type:"patient",tc_identity_no:c,phone_number:i}:{type:"patient",identity_no:p,phone_number:i};w(),M("");const r=await O.post(D.OTP_ATTEMPT,l),N=(r==null?void 0:r.otp_cipher)||(r==null?void 0:r.otp);if(!N)throw new Error("OTP bilgisi alınamadı.");A({otp_cipher:N,phone_number:i,tc_identity_no:l.tc_identity_no,identity_no:l.identity_no}),d.push("/otp")}catch(i){const l=((y=(f=i==null?void 0:i.response)==null?void 0:f.data)==null?void 0:y.message)||"Giriş doğrulaması başarısız.";a(l),t(!0)}finally{x(!1)}}};return e.jsx(I,{children:e.jsx(K,{className:"ion-padding login-page",children:e.jsxs("div",{className:"login-container",children:[e.jsx("div",{className:"logo-container",children:e.jsx(z,{src:"/assets/logo-bezmialem.png",alt:"Bezmialem Vakıf Üniversitesi",className:"logo"})}),e.jsx(j,{children:e.jsx("h1",{className:"title",children:"BEZMİALEM VAKIF KART"})}),e.jsxs("form",{onSubmit:S,className:"login-form",children:[e.jsxs("div",{className:"radio-group",children:[e.jsxs("label",{className:"radio-option"+(s==="tc"?" active":""),children:[e.jsx("input",{type:"radio",name:"login-type",checked:s==="tc",onChange:()=>g("tc")}),"T.C. Kimlik"]}),e.jsxs("label",{className:"radio-option"+(s==="identity"?" active":""),children:[e.jsx("input",{type:"radio",name:"login-type",checked:s==="identity",onChange:()=>g("identity")}),"Diğer"]})]}),s==="tc"?e.jsxs("div",{className:"input-wrapper",children:[e.jsx("label",{htmlFor:"tc-kimlik",className:"input-label",children:"T.C. Kimlik No"}),e.jsx("input",{id:"tc-kimlik",type:"text",maxLength:11,value:c,onChange:o=>k(o.target.value.replace(/\D/g,"")),className:"custom-input",placeholder:"11 haneli kimlik numaranız",inputMode:"numeric"})]}):e.jsxs("div",{className:"input-wrapper",children:[e.jsx("label",{htmlFor:"pasaport-no",className:"input-label",children:"Pasaport No"}),e.jsx("input",{id:"pasaport-no",type:"text",value:p,onChange:o=>C(o.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"")),className:"custom-input",placeholder:"Pasaport numaranız",autoComplete:"off"})]}),e.jsx(B,{phoneNumber:u,countryCode:h,onPhoneChange:b,onCountryCodeChange:T,placeholder:"5XX XXX XX XX",maxLength:10,disabled:m}),e.jsx(L,{expand:"block",type:"submit",className:"login-button",disabled:m,children:"Giriş Yap"}),e.jsx("div",{className:"link-container",children:e.jsx(j,{children:e.jsx("p",{className:"application-check-link",onClick:()=>d.push("/basvuru-kontrolu"),children:"Başvuru Kontrolü"})})})]}),e.jsx(X,{isOpen:v,onDidDismiss:()=>t(!1),message:P,duration:3e3,color:"danger",position:"top"})]})})})};export{Z as default};
