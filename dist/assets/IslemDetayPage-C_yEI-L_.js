import{z as w,r as k,R as p,u as F,j as s,I as O,a as R,k as d,m as o,d as P,i as A,q as C,A as S,c as B,h as z}from"./index-DScGTkQE.js";import{h as D,E}from"./api-BPEy0ugj.js";import{u as H}from"./useEffectOnce-CxcMp374.js";const $=()=>{var j;const m=w(),u=(j=m.state)==null?void 0:j.islem,N=k.useRef(null),[h,L]=p.useState(!1),[f,g]=p.useState(null),x=(()=>{const a=window.location.pathname.split("/"),i=a[a.length-1],n=Number(i);return Number.isFinite(n)?n:void 0})();H(()=>{var a;!((a=m.state)!=null&&a.islem)&&x&&(async()=>{try{const i=await D.post(E.TRANSACTIONS_LIST,z({page:1,limit:50}),{retryMeta:{retry:1}}),n=Array.isArray(i)?i.find(T=>Number(T.id)===x):null;n&&g(n)}catch{}})()});const e=u||f||null;if(!e)return null;const b=async()=>{alert("Rapor indirme bu sürümde OTP sözleşmesine göre kapalı.")},y=F(),v=()=>y.push("/islemler"),r=e.toplamTutar||parseFloat(e.tutar.replace(/[^0-9.-]/g,""))||0;let l=0,t="",c=!1;e.indirimOrani&&e.indirimOrani>0?(l=r*(u.indirimOrani/100),t=`%${e.indirimOrani} Oranında İndirim Uygulandı`,c=!0):e.indirimTutari&&e.indirimTutari>0?(l=e.indirimTutari,t=`₺${e.indirimTutari.toFixed(2)} Sabit İndirim Uygulandı`,c=!0):t="Bu işlemde indirim uygulanmamış";const I=r-l;return s.jsxs(O,{children:[s.jsxs("div",{className:"detay-header",children:[s.jsx("button",{className:"back-btn",onClick:v,children:"← Geri"}),s.jsx("h2",{className:"detay-title",children:e.tur})]}),s.jsx(R,{className:"islem-detay-page",children:s.jsxs("div",{className:"detay-container",ref:N,children:[s.jsx(d,{className:"info-card",children:s.jsxs(o,{children:[s.jsx("h3",{className:"section-title",children:"İşlem Bilgileri"}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Tarih"}),s.jsx("span",{className:"info-value",children:e.tarih})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Doktor"}),s.jsx("span",{className:"info-value",children:e.doktor})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Hastane"}),s.jsx("span",{className:"info-value",children:e.hastane})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"İşlem Türü"}),s.jsx("span",{className:"info-value",children:e.tur})]}),s.jsxs("div",{className:"info-row highlight",children:[s.jsx("span",{className:"info-label",children:"Tutar"}),s.jsx("span",{className:"info-value amount",children:e.tutar})]})]})}),s.jsx(d,{className:"description-card",children:s.jsxs(o,{children:[s.jsx("h3",{className:"section-title",children:"Açıklama"}),s.jsx("p",{className:"description-text",children:e.detay})]})}),s.jsx(d,{className:"discount-card",children:s.jsxs(o,{children:[s.jsx("h3",{className:"section-title",children:"İndirim Bilgileri"}),s.jsxs("div",{className:"discount-info",children:[s.jsx("p",{className:"discount-type",children:t}),c&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"discount-row",children:[s.jsx("span",{className:"discount-label",children:"Toplam Tutar:"}),s.jsxs("span",{className:"discount-value",children:["₺",r.toFixed(2)]})]}),s.jsxs("div",{className:"discount-row",children:[s.jsx("span",{className:"discount-label",children:"İndirim Tutarı:"}),s.jsxs("span",{className:"discount-value discount-amount",children:["-₺",l.toFixed(2)]})]}),s.jsxs("div",{className:"discount-row highlight",children:[s.jsx("span",{className:"discount-label",children:"Net Ödenen:"}),s.jsxs("span",{className:"discount-value net-amount",children:["₺",I.toFixed(2)]})]})]})]})]})}),e.durum==="tamamlandi"&&s.jsx(P,{expand:"block",className:"download-button",onClick:b,disabled:h,children:h?s.jsxs(s.Fragment,{children:[s.jsx(A,{name:"crescent",slot:"start"}),"İndiriliyor..."]}):s.jsxs(s.Fragment,{children:[s.jsx(C,{slot:"start",icon:S}),"Rapor İndir"]})}),s.jsx("div",{className:"help-text",children:s.jsx(B,{color:"medium",children:s.jsx("p",{children:"Bu işlemle ilgili sorularınız için destek ekibimizle iletişime geçebilirsiniz."})})})]})})]})};export{$ as default};
